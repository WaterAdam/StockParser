<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <script>
        $( document ).ready(function() {

            $(".insert-interval-data").click(function(){
                begin_date = $("#begin_date").val();
                end_date = $("#end_date").val();
                alert("收一日data約需1分鐘, 請稍等");

                $.ajax({
                    type: 'POST',
                    url: '/insert_with_interval',
                    data: {'begin': begin_date, 'end': end_date},
                    dataType: "json",

                    success: function(rep){
                        console.log(rep)
                        $("#success_date").html(rep.done);
                        $("#fail_date").html(rep.fail);
                    },
                    error:function(xhr, ajaxOptions, thrownError){
                        alert(thrownError);
                    }
                  });
            });

        });

    </script>
</head>
<body>
    <div class='container'>
        <h2>寫入個股資料</h2>
        <a href="{{ url_for('index') }}" class='btn btn-primary'>Home</a>

        <h2>1. 時間選擇</h2>
        <h2>2. 寫入</h2>
        <div>
            <label class="control-label">起始時間</label>
            <div class="input-daterange input-group" id="datepicker">
                <input type="text" class="input-sm form-control" id='begin_date' value="2021-01-01" placeholder="2022-01-01" name="start" />
                <span class="input-group-addon">to</span>
                <input type="text" class="input-sm form-control" id='end_date' value="2021-01-05" placeholder="2022-01-31" name="end" />
            </div>
            <button id="insert_interval" type="button" class='btn btn-primary insert-interval-data'>寫入DB</button>
        </div>

        <hr size="1px" align="center" width="100%">
        <h3>資料檢查：</h3>
        <div><label>失敗的日期</label></div>
        <textarea id="fail_date" name="textarea" rows="10" cols="50"></textarea>

        <div><label>成功的日期</label></div>
        <textarea id="success_date" name="textarea" rows="10" cols="50"></textarea>

    </div>
</body>
</html>