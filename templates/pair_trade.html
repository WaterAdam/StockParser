<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <script>
        $( document ).ready(function() {
            $(".sid-input").on('input',function(e){
                if ($(this).val().length == 4) {
                    var label = $(this).parent().find('label')
                    $.ajax({
                        type: 'POST',
                        url: '/ajax_stock_name',
                        data: {'sid': $(this).val()},
                        dataType: "json",

                        success: function(rep){
                            console.log(rep);
                            label.html(rep.name);
                        },
                        error:function(xhr, ajaxOptions, thrownError){
                            alert(thrownError);
                        }
                    });
                }
            });

            $("#query").click(function(){
                sid1 = $("#sid1").val();
                sid2 = $("#sid2").val();

                $.ajax({
                    type: 'POST',
                    url: '/ajax_pair_trade',
                    data: {'sid1': sid1, 'sid2': sid2},
                    dataType: "json",

                    success: function(rep){
                        console.log(rep)
                        $("#success_date").html(rep.done);
                        $("#fail_date").html(rep.fail);
                    },
                    error:function(xhr, ajaxOptions, thrownError){
                        alert(thrownError);
                    }
                });
            });

        });

    </script>
</head>
<body>
    <div class='container'>
        <h2>配對交易</h2>
        <a href="{{ url_for('index') }}" class='btn btn-primary'>Home</a>

        <h2>1. 股號選擇</h2>
        <h2>2. 查詢</h2>
        <div>
            <label class="control-label">股號1</label>
            <div>
                <input type="text" id="sid1" name="sid1" class="sid-input">
                <label class="control-label" id="stock1"></label>
            </div>

            <label class="control-label">股號2</label>
            <div>
                <input type="text" id="sid2" name="sid2" class="sid-input">
                <label class="control-label" id="stock2"></label>
            </div>
            <button id="query" type="button" class='btn btn-primary query'>查詢</button>
        </div>

        <hr size="1px" align="center" width="100%">
        <h3>資料檢查：</h3>
        <div id="table_list">

        </div>

    </div>
</body>
</html>